\label{hdInteractome}
\begin{DoubleSpace*}
\section{Cohort}
In order to determine changes in the plasma metabolome associated with myocardial infarction (MI) characterized by thrombotic etiology versus non-thrombotic etiology, DeFilippis and colleagues assembled a human cohort as previously described \cite{defilippis2015,defilippis2017,trainor2017}. Briefly, 80 human subjects presenting with suspected acute MI or stable coronary artery disease (CAD) were enrolled. Utilizing a stringent criteria based on clinical presentation, angiographic evidence, and histological evidence, MI subjects were adjudicated as thrombotic MI or non-thrombotic MI. Blood samples were collected at the time of acute presentation (presentation to the coronary artery catheterization lab prior to procedures) and at a follow-up evaluation approximately three months later. To estimate the structure of a stable heart disease plasma interactome, we used the follow-up evaluations from all available MI subjects as well as the evaluations from stable CAD subjects. The analytical sample thus consisted of 47 whole blood samples from human subjects with definitive heart disease who were not experiencing an acute event at the time of sampling. 

\section{Plasma metabolomics}
\label{plasma}
Details of the metabolite quantification have been described previously \cite{trainor2017}, but a brief overview is provided as follows. Plasma samples were prepared from whole blood and a recovery standard was added. Vigorous shaking was applied utilizing a GenoGrinder 2000 (Glen Mills, Metuchen, NJ) and methanol was added and to precipitate proteins. The extract containing small molecules was divided into five aliquots, four of which were analyzed using different platforms while the remaining aliquot was reserved. Two aliquots were analyzed by ultra-performance liquid chromatography-tandem mass spectrometry (UPLC-MS/MS) with negative and positive ion mode electrospray ionization (ESI). A third aliquot was also analyzed by UPLC-MS/MS with negative ion mode ESI and a method optimized for polar metabolite detection. The fourth aliquot was analyzed by gas chromatography-mass spectrometry (GC-MS). 1,032 chemical features  were detected utilizing the multiple platforms in the analysis of the plasma samples. Of these, 590 compounds were identified by matching to authentic standards based on retention index, mass to charge ratio, and MS2 data; 73 were identified based on experimental data matched to curated databases; and 369 could not be confidently identified. As the original data dependent acquisition was conducted utilizing both acute event samples and stable heart disease samples, metabolites not detected in the stable heart disease samples were removed. Metabolites missing from greater than 70\% of the samples or without compound identification were also removed, resulting in a final dataset with 522 metabolites across 47 samples. Minimum values were then imputed for the remaining metabolite relative abundances with missing data. As many of the metabolites exhibited approximately log-normal relative abundance distributions, metabolite abundances were log-transformed. Finally, the data was mean centered so that each metabolite’s relative abundance distribution was centered about zero. 

\section{Generation of chemical structure informed priors}
A heatmap representation of the structural similarity between metabolites is shown in Figure~\ref{fig:heatmap}. This heatmap was constructed using agglomerative hierarchical clustering using Ward’s method and squared distances (with distance computed as $d_{ij}=1-s_{ij}$, where $s_{ij}$ is the structural similarity between compounds). For illustrative purposes, the cluster containing cholate was retrieved from the root dendrogram by extracting the branch with height X, as the structural-adaptive BGL subnetwork generated by cholate is considered later. Considering clusters generated by branches with low merge heights (high structural similarity), cholate was a member of a cluster with other closely related compounds such as deoxycholate, 3b-hydroxy-5-cholenoic acid, and glycocholate. Considering the more inclusive cluster generated by the branch at join height x, other members included many intermediates in progestagen, androgen, glucocorticoid, and mineralocorticoid steroid metabolic pathways. These steroid hormone metabolites were all members of a cluster with similar within-cluster distances. Finally, at the same branch height that joined steroid hormone and cholate metabolites, a branch consisting of tocopherols cluster and squalene cluster was also joined.
\end{DoubleSpace*}

\newpage
\KOMAoptions{paper=landscape}
\recalctypearea
\begin{figure}[H]
	\includegraphics[scale=.85]{../Aim2/Plots/StructHeatmaps}
	%\resizebox{\textwidth}{!}{\includegraphics*{../Aim2/Plots/StructHeatmaps}}
	\caption[Heatmap showing the molecular structure similarity between the metabolites that were deteced and quantified from the analysis of blood plasma from thrombotic MI, non-thrombotic MI, and stable CAD subjects]{\DoubleSpacing Heatmap showing the molecular structure similarity between the metabolites that were deteced and quantified from the analysis of blood plasma from thrombotic MI, non-thrombotic MI, and stable CAD subjects. Subfigure (a) shows all metabolites, subfigure (b) highlights the dendrogram branch that contains cholate. \label{fig:heatmap} }
\end{figure}
\newpage
\KOMAoptions{paper=portrait,pagesize}
\recalctypearea

\newgeometry{top=1in,left=1.5in,bottom=1in,footskip=.5in}
\begin{DoubleSpace*}
\section{Gibbs sampling}
To approximate the posterior distribution of $p(\boldsymbol{\Omega}|\textbf{X})$, a Markov Chain was generated of length 1,000 with a 250 iteration burn-in period. From each sample from the posterior distribution $p(\boldsymbol{\Omega}|\textbf{X})$, a partial correlation coefficient matrix was computed, yielding a simulated posterior distribution for the matrix of partial correlation coefficients.

\begin{figure}[H]
	\resizebox{1.18\textwidth}{!}{\includegraphics*{../Aim2/Plots/MCMC}}
	\caption[Time series plots for the MCMC sampler for the shrinkage parameter $\lambda_{ij}$ and for the concentration matrix entry $\omega_{ij}$ for the following metabolite pairs: (cholate, tyrosine), (cholate, cortisone), (cholate, glycochenodeoxycholate)]{\DoubleSpacing Time series plots for the MCMC sampler for the shrinkage parameter $\lambda_{ij}$ and for the concentration matrix entry $\omega_{ij}$ for the following metabolite pairs: (cholate, tyrosine), (cholate, cortisone), (cholate, glycochenodeoxycholate).  \label{fig:mcmc} }
\end{figure}

Elements of the MCMC sampling iterations are presented in Figure~\ref{fig:mcmc}. Continuing with the working example of the metabolite cholate, Markov chains are presented for the estimation of the concentration parameters for the pairs (cholate, tyrosine), (cholate, cortisone), and (cholate, glychochenodeoxycholate). These metabolites are highlighted as exemplars of metabolites with relatively low, medium, and relatively high chemical structure similarity with cholate. The time series of the MCMC sampling for the shrinkage parameter, $\lambda_{ij}$, demonstrated differences between the three pairs. Averaged across iterations, more shrinkage was applied with decreasing chemical similarity between the metabolite pairs. While the shrinkage parameter sample values for (cholate, cortisone) tended to be significantly smaller than the sample values for (cholate, cortisone), substantial overlap was observed in the posterior distribution of the concentration parameters for the same pairs.

From the simulated posterior distribution of $\boldsymbol{\Omega}$, the posterior mean $\EE(\boldsymbol{\Omega}|\textbf{X})$ was estimated after discarding burn in iterations. The posterior mean of the distribution of partial correlation coefficients was also computed. The resulting plasma metabolite interactome inferred by the structure-adaptive Bayesian Graphical Lasso is presented in Figure~\ref{fig:stableInter}. This figure presents both the entire graph representing the posterior mean partial correlations as well as the subgraph generated by considering the neighbors of cholate. For ease of viewing, only edges for which $|\rho_{ij}|>0.05$ are plotted in the presentation of the full graph. 

\begin{figure}[H]
	\resizebox{\textwidth}{!}{\includegraphics*{../Aim2/Plots/StableInter}}
	\caption[Graphical representations of the plasma metabolite interactome estimated by the chemical structure adaptive Bayesian Graphical Lasso (BGL) for stable heart disease with subfigures showing the global model as well as the model focused on cholate and its neighbors]{Graphical representation of the plasma metabolite interactome estimated by the chemical structure adaptive Bayesian Graphical Lasso (BGL) for stable heart disease. A simulated posterior distribution for the matrix of partial correlation coefficients was determined from the simulated posterior distribution of the concentration matrix $\boldsymbol{\Omega}$.  Mean values of each partial correlation coefficient were then determined and are represented as colored edges (negative values represented in red, positive values in blue). Subfigure (A) shows all metabolites in the interactome along with edges for which $|\rho|>0.05$.   \label{fig:stableInter} }
\end{figure}

Positive partial correlation coefficients were observed between cholic acid the following other primary bile acids: glycocholic acid, chenodeoxycholic acid, and glycochenodeoxycholic acid. Negative partial correlation coefficients were observed between cholate and the following: taurocholic acid, taurodeoxycholic acid, and taurochenodeoxycholic acid. In addition, the bile acid 7-Hoca and the bile acid conjugate taurolithocholate 3-sulfate were first neighbors of cholic acid. Multiple conjugated androsterones were observed to be first neighbors of cholic acid as was the glucocorticoid cortisone and the steroidal alkaloid solanidine. Other metabolites that were first neighbors of cholic acid included: 3-Carboxy-4-methyl-5-propyl-2-furanpropionic acid (CMPF), eugenol sulfate, erythritol, 2,3-dihydroxyisolvalerate, threonate, quinate, pimelate, and azelate.

\section{Discussion}
Making inferences regarding how metabolic processes differ between phenotypes is the ultimate goal of most metabolomics and systems biology studies. Yet, unlike comparing the concentration or abundance of one metabolite across two or more phenotypes, for which simple statistical tests such as t-tests, Wilcoxon Rank-Sum tests, or multi-group analogues are readily available, a statistical framework for determining if and how metabolic processes differ between phenotypes remains elusive. Both strictly empirical methods (e.g. correlation analyses) and \emph{a priori} knowledge based approaches (e.g. pathway enrichment analyses) suffer from substantial flaws. In terms of empirical methods, the analysis of correlations (such as by the Pearson, Spearman or biweight midcorrelation coefficient) reveals the marginal associations between metabolites; however, these methods do not uncover the relationship between a pair of metabolites conditional on the abundances of the remaining metabolites. Gaussian graphical models have been proposed previously in the context of metabolomics \cite{krumsiek2011} as an alternative, as GGMs can be utilized to determine the partial or conditional relationship between metabolites. In their work Krumsiek et al. \cite{krumsiek2011} show that GGM edges (or concentration matrix entries) estimated from the analysis of blood serum samples from a large human cohort correspond to known metabolic pathway interactions. Consistent with this, our simulation studies illustrate the advantage of analyzing metabolite-metabolite interactions using the partial correlation coefficients from a GGM as opposed to correlation networks. In the case of an autoregressive correlation structure as might be observed given a linear metabolic pathway, correlation networks exhibit extremely high connectivity, and consequently could not be utilized to elucidate the order of reactions. In contrast, we observe high sensitivity and specificity in detecting the true edges using a Bayesian Graphical Lasso estimated GGM. While the approach utilized by Krumsiek et al. \cite{krumsiek2011} was appropriate for the analysis of their data, it would not be possible to apply this approach in studies in which the sample size is smaller than the number of metabolites, as is common in many metabolomics studies. Frequentist regularization methods represent a class of solutions for ensuring that the concentration matrix, or equivalent GGM topology is estimable. In an implicit manner, frequentist regularization methods for estimating GGMs place a higher \emph{a priori} probability on models with concentration matrix entries of smaller magnitude \cite{wang2012}. However, this implicit prior cannot incorporate \emph{a priori} knowledge as to whether some metabolites are more likely to be related than others.

In contrast to empirical methods, a priori knowledge based approaches such as pathway enrichment analyses consider the relationships between metabolites to be deterministically known which are then used to contextualize empirical results. Previous work \cite{barupal2012,barupal2017} has highlighted that the coverage of metabolites detected in metabolomics studies in commonly utilized metabolic pathway and reaction databases may be extremely low. For example, Barupal et al. \cite{barupal2017} observe that given 385 metabolites identified from the plasma of non-obese diabetic (NOD) mice, only 135 metabolites (or 35.1\%) could be mapped to KEGG pathways \cite{kanehisa2000,kanehisa2016}. To address this problem, Barupal et al. \cite{barupal2017} propose an alternative approach that utilizes both existing chemical ontological terms and chemical similarity between metabolites to develop coherent categories of metabolites for enrichment analyses. In the current work, we have sought a framework for balancing the benefits of empiricism with the benefits of a priori knowledge based approaches, while seeking to minimize the risks associated with both approaches. As opposed to considering metabolites as deterministically assigned to fixed pathways, our approach assumes that metabolites that are linked by biochemical reactions will exhibit overlap in local substructures. From this, our approach generates prior distributions for shrinkage parameters for the estimation of Gaussian graphical models. The posterior distribution of GGM parameters is thus proportional to the likelihood of the concentration matrix parameters (or the partial correlations between metabolites) times the prior probability of the concentration matrix parameters (which are linked to the structural similarity between metabolites). Similar to the non-informative BGL approach, this approach ensures that the concentration matrix is estimable via the Bayesian analog of regularization, however the regularization is applied given the prior belief that stronger associations are a priori more likely given structurally related compounds than unrelated compounds. While we find better justification for using structural similarity to generate prior probability distributions for shrinkage parameters in estimating a GGM, this approach would generalize to the use of priors from metabolic pathway maps. A previous work sought to estimate a GGM using 17 compounds quantified by NMR from 24 microglia cell culture samples using priors determined from KEGG \cite{peterson2013}.

In addition to evaluation via simulation studies, we have applied the chemical structure adaptive BGL to generate a media-specific (blood plasma) metabolite interactome for stable heart disease. This model may serve as a reference model for comparing how the probabilistic interactions between metabolites in circulation change during acute disease events such as myocardial infarction or unstable angina. From this model, we have observed probabilistic interactions that are consistent with previous research in metabolism, as can be observed by focusing on the metabolite cholate. Bile acids are the major catabolic intermediate of cholesterol \cite{russell2003}. Within mammals, the bile acid pool consists of primary bile acids such as cholic acid and chenodeoxycholic acid which are synthesized from cholesterol by enzymes expressed in hepatocytes, as well as secondary bile acids that are synthesized from primary bile acids by bacteria in the gut \cite{garcia2012,hofmann2010,russell2003}. In addition to bile acids aiding in the digestion of nutrients in the gut, bile acids also act as signaling molecules that have been shown to regulate glucose and lipid metabolism \cite{ferrebee2015,khurana2011}. Given the substantial proportion of cholesterol that is converted to bile acids leading to elimination, bile acid metabolism is linked to atherosclerosis \cite{meissner2013}. In addition bile acids as signaling molecules affect cardiac \cite{desai2017,rainer2013} and circulatory physiology \cite{khurana2011} via direct effects such as taurodeoxycholic acid mediated vasodilation \cite{khurana2005}. With respect to the current work, we observed relatively strong partial correlation between cholic acid and other primary bile acids. Additionally, partial correlations were observed between cholic acid and steroid hormones that share cholesterol as a common precursor. Given the importance of bile acids in cholesterol metabolism, atherosclerosis, cardiac physiology and circulatory physiology, a reference model of the probabilistic interactions of bile acids in circulation can help elucidate how acute disease events impact bile acid metabolism.

As with any Bayesian approach, the choice of prior probability distribution has a direct influence on the posterior distribution of model parameters \cite{gelman2004}. In the current work, we have utilized informative priors that are linked to chemical structure similarity. This represents a potential limitation of the current work. Over the course of the simulation studies, we observed, unsurprisingly, that by introducing random noise into the simulated structural similarity the performance of the chemical structure adaptive BGL deteriorated. Further, the performance of the technique given “poor” prior information was, on average, worse than the performance of techniques such as the non-adaptive BGL that rely on non-informative priors. One element of the chemical structure adaptive BGL is worth noting in this context. In our proposed formulation, other monotonic functions for relating structural similarity to the Gamma scale parameter may be employed, as well as different shape and scale hyperparameters can be utilized. In this manner, the experimenter can diminish or strengthen the degree to which structural similarity impacts shrinkage. A second limitation of the current work is the choice of a multivariate Gaussian distribution for representing the joint distribution of metabolite abundances. While transformations in the stable heart disease data were applied over each metabolite to reduce the degree of departure from normality, the underlying intensity data is not normally distributed. Further, there are many cases in which approximate normality is not an achievable aim. A metabolite that is only present in some samples (e.g. acetaminophen metabolites that are present in some human subjects who have taken this medication, but not others) is one such case. Following a missing value imputation procedure, such a metabolite would exhibit a bimodal distribution that would not be well described by a Gaussian model. 

\end{DoubleSpace*}